<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Create mask and hydro maps &mdash; GEB 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="2. Scale CWatM input data" href="2_scale_cwatm.html" />
    <link rel="prev" title="Preprocessing" href="preprocessing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> GEB
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="preprocessing.html">Preprocessing</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">1. Create mask and hydro maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_scale_cwatm.html">2. Scale CWatM input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_scrape_command_areas.html">3. Scrape command areas</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_create_lakes_and_reservoirs.html">4. Create land and reservoir map</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_create_land_use_map.html">5. Create land use map</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_get_farm_sizes.html">6. Create farm size map</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_get_irrigation_source.html">7. Get irrigation sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="8_create_farmers.html">8. Create farmers</a></li>
<li class="toctree-l2"><a class="reference internal" href="9_pick_farmer_crops.html">9. Pick farmer crops</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_preprocess_modflow.html">10. Preprocess MODFLOW data</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_other_data.html">11. Other data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running.html">Running the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HRUs.html">Farm-level HRUs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Agents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../agents/__init__.html">Agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/farmers.html">Farmers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/ngo.html">NGO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/government.html">Government</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../model.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cwatm_model.html">CWatM Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../report.html">Report</a></li>
<li class="toctree-l1"><a class="reference internal" href="../artists.html">Artists</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../authors_page.html">Authors</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GEB</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="preprocessing.html">Preprocessing</a> &raquo;</li>
      <li><span class="section-number">1. </span>Create mask and hydro maps</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/preprocessing/1_create_mask_and_hydro_maps.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="create-mask-and-hydro-maps">
<h1><span class="section-number">1. </span>Create mask and hydro maps<a class="headerlink" href="#create-mask-and-hydro-maps" title="Permalink to this heading"></a></h1>
<p>GEB uses a mask for the hydrological model (just as in CWatM), and a submask to represent the subcells. After creating the mask, the submask is created at a higher resolution as specified in <cite>UPSCALE_FACTOR</cite>. The hydrological units are then created by merging these very small subcells.</p>
<p>However, first we need some data. Start by downloading the original <a class="reference external" href="http://hydro.iis.u-tokyo.ac.jp/~yamadai/MERIT_Hydro/">MERIT Hydro elevation map</a>. After registering you can download the “Adjusted Elevation” for your area. This data is required to calculate determine the standard deviation for your file. Decompress and save all output files in <cite>ROOT/original_data/merit_hydro_03sec/</cite>. It is recommended to download the <cite>Upstream Drainage Pixel</cite> too and place in the same the same folder as you will need this for a later step.</p>
<p>Next download, <cite>30sec_basids.tif</cite>, <cite>30sec_elevtn.tif</cite>, <cite>30sec_uparea.tif</cite>, <cite>30sec_rivlen_ds.tif</cite>, <cite>30sec_rivslp.tif</cite> and <cite>30sec_flwdir.tif</cite> from <a class="reference external" href="https://zenodo.org/record/5166932">Zenodo</a> and place in <cite>ROOT/original_data/merit_hydro_30sec</cite>. Now run <cite>preprocessing.1_create_mask_and_hydro_maps.py</cite> to create the mask, submask and several hydrological maps.</p>
<span class="target" id="module-preprocessing.1_create_mask_and_hydro_maps"></span><dl class="py function">
<dt class="sig sig-object py" id="preprocessing.1_create_mask_and_hydro_maps.create_cell_area_map">
<span class="sig-name descname"><span class="pre">create_cell_area_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_profile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/preprocessing/1_create_mask_and_hydro_maps.html#create_cell_area_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#preprocessing.1_create_mask_and_hydro_maps.create_cell_area_map" title="Permalink to this definition"></a></dt>
<dd><p>Create cell area map for given rasterio profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_profile</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code>) – Rasterio profile of basin mask</p></li>
<li><p><strong>prefix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Filename prefix</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="preprocessing.1_create_mask_and_hydro_maps.create_ldd">
<span class="sig-name descname"><span class="pre">create_ldd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_profile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/preprocessing/1_create_mask_and_hydro_maps.html#create_ldd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#preprocessing.1_create_mask_and_hydro_maps.create_ldd" title="Permalink to this definition"></a></dt>
<dd><p>Clip ldd, and convert ArcGIS D8 convention to pcraster LDD convention.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mask_profile</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code>) – Rasterio profile of basin mask</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="preprocessing.1_create_mask_and_hydro_maps.create_mask">
<span class="sig-name descname"><span class="pre">create_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basin_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upscale_factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/preprocessing/1_create_mask_and_hydro_maps.html#create_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#preprocessing.1_create_mask_and_hydro_maps.create_mask" title="Permalink to this definition"></a></dt>
<dd><p>This function creates a mask and a submask (using global UPSCALE_FACTOR), and returns rasterio profile for both</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basin_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The basin id of the <cite>merit_hydro_30sec/30sec_basids.tif</cite></p></li>
<li><p><strong>upscale_factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The size of the subcell mask relative to the basin mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>mask_profile</strong> – rasterio profile for mask</p></li>
<li><p><strong>submask_profile</strong> – rasterio profile for submask</p></li>
</ul>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="preprocessing.1_create_mask_and_hydro_maps.create_mask_shapefile">
<span class="sig-name descname"><span class="pre">create_mask_shapefile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/preprocessing/1_create_mask_and_hydro_maps.html#create_mask_shapefile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#preprocessing.1_create_mask_and_hydro_maps.create_mask_shapefile" title="Permalink to this definition"></a></dt>
<dd><p>Creates a shapefile from the basin mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="preprocessing.1_create_mask_and_hydro_maps.get_channel_manning_and_width">
<span class="sig-name descname"><span class="pre">get_channel_manning_and_width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_profile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/preprocessing/1_create_mask_and_hydro_maps.html#get_channel_manning_and_width"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#preprocessing.1_create_mask_and_hydro_maps.get_channel_manning_and_width" title="Permalink to this definition"></a></dt>
<dd><p>Estimate channel Manning’s roughness coefficient, and channel width.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mask_profile</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code>) – Rasterio profile of basin mask</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="preprocessing.1_create_mask_and_hydro_maps.get_elevation_std">
<span class="sig-name descname"><span class="pre">get_elevation_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_profile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/preprocessing/1_create_mask_and_hydro_maps.html#get_elevation_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#preprocessing.1_create_mask_and_hydro_maps.get_elevation_std" title="Permalink to this definition"></a></dt>
<dd><p>Clips 30 arcsecond elevation map to mask, and creates map of standard deviation in elevation map using the 3 arcsecond elevation map.</p>
<p>All MERIT Hydro elevation files should be in <cite>ROOT/original_data/merit_hydro_03sec</cite>.</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>mask_profile: Rasterio profile of basin mask</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="preprocessing.1_create_mask_and_hydro_maps.get_river_length_and_channelratio">
<span class="sig-name descname"><span class="pre">get_river_length_and_channelratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_profile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/preprocessing/1_create_mask_and_hydro_maps.html#get_river_length_and_channelratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#preprocessing.1_create_mask_and_hydro_maps.get_river_length_and_channelratio" title="Permalink to this definition"></a></dt>
<dd><p>Clips channel length to mask, and calculates channel ratio from cell area, channel length and channel width</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mask_profile</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code>) – Rasterio profile of basin mask</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="preprocessing.1_create_mask_and_hydro_maps.get_river_slope">
<span class="sig-name descname"><span class="pre">get_river_slope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_profile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/preprocessing/1_create_mask_and_hydro_maps.html#get_river_slope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#preprocessing.1_create_mask_and_hydro_maps.get_river_slope" title="Permalink to this definition"></a></dt>
<dd><p>Clips riverslope map to mask, and outputs as channelgradient</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mask_profile</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code>) – Rasterio profile of basin mask</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="preprocessing.html" class="btn btn-neutral float-left" title="Preprocessing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="2_scale_cwatm.html" class="btn btn-neutral float-right" title="2. Scale CWatM input data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../copyright.html">Copyright</a> 2022, IIASA and VU-IVM.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>